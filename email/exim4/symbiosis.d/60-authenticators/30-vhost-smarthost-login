vhost_smarthost_login:
  driver = plaintext
  public_name = LOGIN
  client_condition = ${if \
    and{\
      {!eq{$tls_out_cipher}{}}\
      {exists{VHOST_DIR/$sender_address_domain/VHOST_CONFIG_DIR/smarthost}}\
    }}
  client_send = "<; ${if match{${readfile{VHOST_DIR/$sender_address_domain/VHOST_CONFIG_DIR/smarthost}}}{VHOST_SMARTHOST_AUTH_REGEX}{}fail} ; \
                    ${if match{${readfile{VHOST_DIR/$sender_address_domain/VHOST_CONFIG_DIR/smarthost}}}{VHOST_SMARTHOST_AUTH_REGEX}{$1}fail} ; \
                    ${if match{${readfile{VHOST_DIR/$sender_address_domain/VHOST_CONFIG_DIR/smarthost}}}{VHOST_SMARTHOST_AUTH_REGEX}{$2}fail}"

